# 货币数据建模


## Overview

- MongoDB使用浮点数存储数组类型数据；
- 处理货币数据的应用程序经常需要处理数据的小数部分，然而，由于浮点数本身的问题，这一点经常做不到；
- 浮点数也不能很好地保存分数
- 本文介绍货币数据建模的方式：
	- 准确精度模型
	- 任意精度模型

## 准确精度模型

如果你需要在服务器端执行与货币数据有关的计算，那你应该使用准确精度模型。

如果要对货币数据进行准确精度模型建模，你应该：
- 确定货币数据的最大精度；
- 根据确定的精度，将货币数据乘以10的N次幂（N的值由最大精度确定），将其转换成整数。例如，如果你确定精度到“分”，最大精度是小数点后2位。因此，需要将货币数据乘以10的2次幂。
- 保存转换后的整数。

例如，以下代码存储“$9.99”，精度为“0.1分”：

`{ price: 9990, currency: "USD" }`


## Arbitrary Precision

如果不需要在服务器端对货币数据进行计算，则可以使用任意精度模型。

如果要对货币数据进行任务精度模型建模，你应该：
- 在一个字段中将货币数据转换为非数值类型（如string或BinData）存放；
- 在另一个字段中保存货币数据的原始浮点值。

例如，以下代码存储“$9.99”和“$0.25”：

```
{
  price: { display: "9.99", approx: 9.9900000000000002, currency: "USD" },
  fee: { display: "0.25", approx: 0.2499999999999999, currency: "USD" }
}
```
